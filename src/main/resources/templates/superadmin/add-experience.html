<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IntervuLog | Add Interview Experiences</title>
  <link rel="icon" href="icon.png" type="image/png">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800 font-sans">

<header class="bg-white shadow px-6 py-4 flex flex-col sm:flex-row sm:items-center sm:justify-between">
  <a href="/dashboard" class="text-2xl font-bold text-indigo-700 flex items-center gap-2">üóÇÔ∏è <span>IntervuLog ‚Äì Super Admin</span></a>
  <a href="/logout" class="text-sm text-red-600 font-semibold hover:underline">Logout</a>
</header>

<main class="max-w-5xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
  <h1 class="text-3xl font-bold text-indigo-700 mb-6">Internship Details Submission</h1>

  <form id="internshipForm" action="/superadmin/add-experience" method="post" th:action="@{/superadmin/add-experience}" class="space-y-8 bg-white p-6 rounded-xl shadow">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

    <section>
      <h2 class="text-xl font-semibold text-gray-800 mb-4">Personal Information</h2>
      <div class="space-y-4">
        <div>
          <label for="fullName" class="block text-sm font-medium">Full Name</label>
          <input type="text" id="fullName" name="fullName" placeholder="FirstName Surname" required class="w-full border rounded-md px-3 py-2 shadow-sm"/>
        </div>
        <div>
          <label for="course" class="block text-sm font-medium">Course/Branch</label>
          <select id="course" name="course" required class="w-full border rounded-md px-3 py-2 shadow-sm">
            <option value="CS">Btech Computer Science</option>
            <option value="CSE">Btech Computer Science Engineering</option>
            <option value="EXTC">Btech EXTC</option>
            <option value="MCA">MCA</option>
            <option value="Mtech">Mtech</option>
          </select>
        </div>
      </div>
    </section>

    <section>
      <h2 class="text-xl font-semibold text-gray-800 mb-4">Company & Job Details</h2>
      <div class="space-y-4">
        <div>
          <label for="company" class="block text-sm font-medium">Company</label>
          <select id="company" name="company" onchange="toggleCompanyInput()" required class="w-full border rounded-md px-3 py-2 shadow-sm">
            <option th:each="company : ${companies}" th:value="${company.name}" th:text="${company.name}"></option>
            <option value="Other">Other</option>
          </select>
          <div id="companyInputDiv" class="mt-3 hidden">
            <label for="otherCompany" class="block text-sm font-medium">Specify Company Name</label>
            <input type="text" id="otherCompany" name="otherCompany" placeholder="Enter company name" class="w-full border rounded-md px-3 py-2 shadow-sm"/>
          </div>
        </div>

        <div>
          <label for="jobProfile" class="block text-sm font-medium">Job Profile</label>
          <select id="jobProfile" name="jobProfile" onchange="toggleJobProfileInput()" required class="w-full border rounded-md px-3 py-2 shadow-sm">
            <option value="SDE">SDE</option>
            <option value="Business Analyst">Business Analyst</option>
            <option value="Other">Other</option>
          </select>
          <div id="jobProfileInputDiv" class="mt-3 hidden">
            <label for="otherJobProfile" class="block text-sm font-medium">Specify Job Profile</label>
            <input type="text" id="otherJobProfile" name="otherJobProfile" placeholder="Enter job profile" class="w-full border rounded-md px-3 py-2 shadow-sm"/>
          </div>
        </div>

        <div>
          <label for="offerType" class="block text-sm font-medium">Offer Type</label>
          <select id="offerType" name="offerType" onchange="toggleOfferFields()" required class="w-full border rounded-md px-3 py-2 shadow-sm">
            <option value="Internship(performance-based offer)">Internship (performance-based offer)</option>
            <option value="InternshipOnly">Internship only</option>
            <option value="PlacementOnly">Placement only</option>
            <option value="InternshipPlacement">Internship + Placement</option>
          </select>
        </div>

        <div id="stipendDiv">
          <label for="internshipStipend" class="block text-sm font-medium">Internship Stipend</label>
          <input type="text" id="internshipStipend" name="internshipStipend" placeholder="20000" class="w-full border rounded-md px-3 py-2 shadow-sm"/>
        </div>

        <div id="ctcDiv">
          <label for="ctc" class="block text-sm font-medium">CTC (in LPA)</label>
          <input type="text" id="ctc" name="ctc" placeholder="For 8LPA -> 800000" class="w-full border rounded-md px-3 py-2 shadow-sm"/>
        </div>

        <div>
          <label for="location" class="block text-sm font-medium">Location</label>
          <select id="location" name="location" required class="w-full border rounded-md px-3 py-2 shadow-sm">
            <option value="" disabled selected>Select a location</option>
            <option th:each="loc : ${locations}" th:value="${loc.name}" th:text="${loc.name}"></option>
          </select>
        </div>

        <div>
          <label for="processDate" class="block text-sm font-medium">Process Date</label>
          <input type="date" id="processDate" name="processDate" required class="w-full border rounded-md px-3 py-2 shadow-sm"/>
        </div>
      </div>
    </section>

    <section>
      <h2 class="text-xl font-semibold">Placement Process</h2>
      <div id="roundsContainer" class="space-y-6">
          <!--  Interview Rounds  -->
      </div>
      <button type="button" onclick="addRound()" class="mt-3 bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600">+ Add New Round</button>
    </section>

      <section>
      <h2 class="text-xl font-semibold text-gray-800 mb-4">Additional Information</h2>
      <div class="space-y-4">
        <div>
          <label for="linkedin" class="block text-sm font-medium">LinkedIn Profile (optional)</label>
          <input type="url" id="linkedin" name="linkedin" class="w-full border rounded-md px-3 py-2 shadow-sm" />
        </div>
        <div>
          <label for="comments" class="block text-sm font-medium">Additional Comments or Advice</label>
          <textarea id="comments" name="comments" rows="5" class="w-full border rounded-md px-3 py-2 shadow-sm"></textarea>
        </div>
      </div>
    </section>

    <div>
      <button type="submit" class="w-full bg-indigo-600 text-white font-semibold py-3 rounded-md hover:bg-indigo-700 transition">Submit</button>
    </div>
  </form>
</main>

<script>
  let roundCount = 0;

  function toggleCompanyInput() {
    const companySelect = document.getElementById('company');
    const companyInputDiv = document.getElementById('companyInputDiv');
    companyInputDiv.style.display = companySelect.value === 'Other' ? 'block' : 'none';
  }

  function toggleJobProfileInput() {
    const jobProfileSelect = document.getElementById('jobProfile');
    const jobProfileInputDiv = document.getElementById('jobProfileInputDiv');
    jobProfileInputDiv.style.display = jobProfileSelect.value === 'Other' ? 'block' : 'none';
  }

  function toggleOfferFields() {
    const offerType = document.getElementById('offerType').value;
    const stipendDiv = document.getElementById('stipendDiv');
    const ctcDiv = document.getElementById('ctcDiv');

    if (offerType === 'InternshipOnly') {
      stipendDiv.style.display = 'block';
      ctcDiv.style.display = 'none';
    } else if (offerType === 'PlacementOnly') {
      stipendDiv.style.display = 'none';
      ctcDiv.style.display = 'block';
    } else {
      stipendDiv.style.display = 'block';
      ctcDiv.style.display = 'block';
    }
  }

  function toggleRoundTypeInput(roundNumber) {
    const roundTypeSelect = document.getElementById(`roundType${roundNumber}`);
    const roundTypeInputDiv = document.getElementById(`roundTypeInputDiv${roundNumber}`);
    roundTypeInputDiv.style.display = roundTypeSelect.value === 'Other' ? 'block' : 'none';
  }

  function addRound() {
    roundCount++;
    const newRound = document.createElement('div');
    newRound.classList.add('round-section', 'p-4', 'mb-4', 'rounded-xl', 'border', 'border-indigo-300', 'bg-indigo-50', 'shadow-sm');
    newRound.id = `round${roundCount}`;
    newRound.innerHTML = `
      <div class="round-header font-semibold text-lg text-indigo-700 mb-4">Round ${roundCount}</div>

      <label for="roundType${roundCount}" class="block font-medium text-sm text-gray-700 mb-1">Round Type:</label>
      <select id="roundType${roundCount}" name="roundType${roundCount}" onchange="toggleRoundTypeInput(${roundCount})" required
              class="w-full p-2 mb-4 border border-slate-300 rounded focus:outline-none focus:ring-2 focus:ring-indigo-400 bg-white">
          <option value="Online Assessment">Online Assessment</option>
          <option value="Technical">Technical</option>
          <option value="HR">HR</option>
          <option value="Other">Other</option>
      </select>

      <div id="roundTypeInputDiv${roundCount}" class="input-box mb-4 hidden">
          <label for="otherRoundType${roundCount}" class="block font-medium text-sm text-gray-700 mb-1">Please specify the round type:</label>
          <input type="text" id="otherRoundType${roundCount}" name="otherRoundType${roundCount}" placeholder="Enter round type"
                 class="w-full p-2 border border-slate-300 rounded focus:outline-none focus:ring-2 focus:ring-indigo-400 bg-white">
      </div>

      <div class="question-section" id="questions${roundCount}">
          <label class="block font-medium text-sm text-gray-700 mb-2">Questions:</label>
          <div class="question mb-4">
              <label for="q${roundCount}_1" class="block text-sm font-semibold text-gray-700 mb-1">Question 1:</label>
              <textarea id="q${roundCount}_1" name="q${roundCount}_1" rows="4" cols="50" placeholder="Describe the question and your approach." required
                        class="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-indigo-300"></textarea>
          </div>
      </div>
      <span class="add-question inline-block px-3 py-1.5 text-sm font-medium text-indigo-700 bg-indigo-100 hover:bg-indigo-200 rounded-md cursor-pointer transition-colors" onclick="addQuestion(${roundCount})">+ Add Question </span>
      <span class="remove-round inline-block px-3 py-1.5 text-sm font-medium text-red-600 border border-red-300 hover:bg-red-50 rounded-md cursor-pointer transition-colors ml-3" onclick="removeRound(${roundCount})"> üóë Remove Round </span>
    `;
    document.getElementById('roundsContainer').appendChild(newRound);
  }

  function addQuestion(roundNumber) {
    const questionCount = document.getElementById(`questions${roundNumber}`).getElementsByClassName('question').length + 1;
    const newQuestion = document.createElement('div');
    newQuestion.classList.add('question', 'mb-4');
    newQuestion.innerHTML = `
      <label for="q${roundNumber}_${questionCount}" class="block text-sm font-semibold text-gray-700 mb-1">Question ${questionCount}:</label>
      <textarea id="q${roundNumber}_${questionCount}" name="q${roundNumber}_${questionCount}" rows="4" cols="50" placeholder="Describe the question and your approach." required
                class="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-indigo-300"></textarea>
    `;
    document.getElementById(`questions${roundNumber}`).appendChild(newQuestion);
  }

  function removeRound(roundNumber) {
    const round = document.getElementById(`round${roundNumber}`);
    round.remove();

    const rounds = document.querySelectorAll('.round-section');
    roundCount = rounds.length;

    rounds.forEach((round, index) => {
      const newIndex = index + 1;
      round.querySelector('.round-header').textContent = `Round ${newIndex}`;
      round.id = `round${newIndex}`;

      const select = round.querySelector('select');
      select.id = `roundType${newIndex}`;
      select.name = `roundType${newIndex}`;
      select.setAttribute('onchange', `toggleRoundTypeInput(${newIndex})`);

      const roundTypeDiv = round.querySelector('.input-box');
      roundTypeDiv.id = `roundTypeInputDiv${newIndex}`;
      const input = roundTypeDiv.querySelector('input');
      input.id = `otherRoundType${newIndex}`;
      input.name = `otherRoundType${newIndex}`;

      const questionSection = round.querySelector('.question-section');
      questionSection.id = `questions${newIndex}`;
      const questions = questionSection.querySelectorAll('.question');

      questions.forEach((q, qIndex) => {
        const textarea = q.querySelector('textarea');
        textarea.id = `q${newIndex}_${qIndex + 1}`;
        textarea.name = `q${newIndex}_${qIndex + 1}`;

        const label = q.querySelector('label');
        if (label) label.textContent = `Question ${qIndex + 1}:`;
        label.classList.add('block', 'text-sm', 'font-semibold', 'text-gray-700', 'mb-1');
      });

      round.querySelector('.add-question').setAttribute('onclick', `addQuestion(${newIndex})`);
      round.querySelector('.remove-round').setAttribute('onclick', `removeRound(${newIndex})`);
    });
  }

  window.onload = function () {
    toggleCompanyInput();
    toggleJobProfileInput();
    toggleOfferFields();
    addRound();
  };
</script>


</body>
</html>
