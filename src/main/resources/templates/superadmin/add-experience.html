<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IntervuLog | Add Interview Experiences</title>
  <link rel="icon" th:href="@{/icon.png}" type="image/png">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;700&display=swap');
    body {
        font-family: 'DM Sans', sans-serif;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800 font-sans">
<!--Header-->
<div th:replace="~{fragments/superadmin-header :: superadminHeader}"></div>

<main class="max-w-5xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
  <h1 class="text-3xl font-bold text-indigo-700 mb-6">Interview Details Submission</h1>

  <form id="internshipForm" action="/superadmin/add-experience" method="post" th:action="@{/superadmin/add-experience}" class="space-y-8 bg-white p-6 rounded-xl shadow">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

    <section>
      <h2 class="text-xl font-semibold text-gray-800 mb-4">Personal Information</h2>
      <div class="space-y-4">
        <div>
          <label for="fullName" class="block text-sm font-medium">Full Name</label>
          <input type="text" id="fullName" name="fullName" placeholder="Kshitij Mahale" required class="w-full border rounded-md px-3 py-2 shadow-sm"/>
        </div>
        <div>
          <label for="course" class="block text-sm font-medium">Course/Branch</label>
          <select id="course" name="course" required class="w-full border rounded-md px-3 py-2 shadow-sm">
            <option value="COMP">Comp</option>
            <option value="EXTC">EXTC</option>
            <option value="DS">CSE - DS</option>
            <option value="AIML">CSE - AIML</option>
            <option value="IT">IT</option>
            <option value="MCA">MCA</option>
            <option value="Mtech">Mtech</option>
          </select>
        </div>
      </div>
    </section>

    <section>
      <h2 class="text-xl font-semibold text-gray-800 mb-4">Company & Job Details</h2>
      <div class="space-y-4">
        <div>
          <label for="company" class="block text-sm font-medium">Company</label>
          <select id="company" name="company" onchange="toggleCompanyInput()" required class="w-full border rounded-md px-3 py-2 shadow-sm">
            <option th:each="company : ${companies}" th:value="${company.name}" th:text="${company.name}"></option>
<!--            <option value="Other">Other</option>-->
          </select>
          <div id="companyInputDiv" class="mt-3 hidden">
            <label for="otherCompany" class="block text-sm font-medium">Specify Company Name</label>
            <input type="text" id="otherCompany" name="otherCompany" placeholder="Enter company name" class="w-full border rounded-md px-3 py-2 shadow-sm"/>
          </div>
        </div>

        <div>
          <label for="jobProfile" class="block font-medium">Job Profile:</label>
          <select id="jobProfile" name="jobProfile" onchange="toggleJobProfileInput()" required class="w-full border rounded p-2 mt-1">
            <option value="" disabled selected>Select a job profile</option>
            <option value="AI Engineer">AI Engineer</option>
            <option value="App Developer">App Developer</option>
            <option value="Associate Manager">Associate Manager</option>
            <option value="Business Analyst">Business Analyst</option>
            <option value="Data Analyst">Data Analyst</option>
            <option value="Data Scientist">Data Scientist</option>
            <option value="Java Developer">Java Developer</option>
            <option value="Machine Learning Engineer">Machine Learning Engineer</option>
            <option value="SDE">SDE</option>
            <option value="Software Developer">Software Developer</option>
            <option value="Other">Other</option>
          </select>
          <div id="jobProfileInputDiv" class="mt-3 hidden">
            <label for="otherJobProfile" class="block text-sm font-medium">Specify Job Profile</label>
            <input type="text" id="otherJobProfile" name="otherJobProfile" placeholder="Enter job profile" class="w-full border rounded-md px-3 py-2 shadow-sm"/>
          </div>
        </div>

        <div>
          <label for="offerType" class="block text-sm font-medium">Offer Type</label>
          <select id="offerType" name="offerType" onchange="toggleOfferFields()" required class="w-full border rounded-md px-3 py-2 shadow-sm">
            <option value="Internship(performance-based offer)">Internship (performance-based offer)</option>
            <option value="InternshipOnly">Internship only</option>
            <option value="PlacementOnly">Placement only</option>
            <option value="InternshipPlacement">Internship + Placement</option>
          </select>
        </div>

        <div id="stipendDiv">
          <label for="internshipStipend" class="block text-sm font-medium">Internship Stipend</label>
          <input type="text" id="internshipStipend" name="internshipStipend" placeholder="20000" class="w-full border rounded-md px-3 py-2 shadow-sm"/>
        </div>

        <div id="ctcDiv">
          <label for="ctc" class="block text-sm font-medium">CTC (in LPA)</label>
          <input type="text" id="ctc" name="ctc" placeholder="For 8LPA -> 800000" class="w-full border rounded-md px-3 py-2 shadow-sm"/>
        </div>

        <div>
          <label for="location" class="block text-sm font-medium">Location</label>
          <select id="location" name="location" required class="w-full border rounded-md px-3 py-2 shadow-sm">
            <option value="" disabled selected>Select a location</option>
            <option th:each="loc : ${locations}" th:value="${loc.name}" th:text="${loc.name}"></option>
          </select>
        </div>

        <div>
          <label for="processDate" class="block text-sm font-medium">Process Date</label>
          <input type="date" id="processDate" name="processDate" required class="w-full border rounded-md px-3 py-2 shadow-sm"/>
        </div>
      </div>
    </section>

    <section>
      <h2 class="text-xl font-semibold">Placement Process</h2>
      <div id="roundsContainer" class="space-y-6">
          <!--  Interview Rounds  -->
      </div>
      <button type="button" onclick="addRound()" class="mt-3 bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600">+ Add New Round</button>
    </section>

      <section>
      <h2 class="text-xl font-semibold text-gray-800 mb-4">Additional Information</h2>
      <div class="space-y-4">
        <div>
          <label for="linkedin" class="block text-sm font-medium">LinkedIn Profile (optional)</label>
          <input type="url" id="linkedin" name="linkedin" class="w-full border rounded-md px-3 py-2 shadow-sm" />
        </div>
        <div>
          <label for="comments" class="block text-sm font-medium">Additional Comments or Advice</label>
          <textarea id="comments" name="comments" rows="5" class="w-full border rounded-md px-3 py-2 shadow-sm"
                    placeholder="You can paste helpful links too, like YouTube, Whimsical, etc.&#10;Example:&#10;For OOPS: https://whimsical.com/oops-link"></textarea>
        </div>
      </div>
    </section>

    <div>
      <button type="submit" class="w-full bg-indigo-600 text-white font-semibold py-3 rounded-md hover:bg-indigo-700 transition">Submit</button>
    </div>
  </form>
</main>

<script>
  let roundCount = 0;

  function toggleCompanyInput() {
    const companySelect = document.getElementById('company');
    const companyInputDiv = document.getElementById('companyInputDiv');
    companyInputDiv.style.display = companySelect.value === 'Other' ? 'block' : 'none';
  }

  function toggleJobProfileInput() {
    const jobProfileSelect = document.getElementById('jobProfile');
    const jobProfileInputDiv = document.getElementById('jobProfileInputDiv');
    jobProfileInputDiv.style.display = jobProfileSelect.value === 'Other' ? 'block' : 'none';
  }

  function toggleOfferFields() {
    const offerType = document.getElementById('offerType').value;
    const stipendDiv = document.getElementById('stipendDiv');
    const ctcDiv = document.getElementById('ctcDiv');

    if (offerType === 'InternshipOnly') {
      stipendDiv.style.display = 'block';
      ctcDiv.style.display = 'none';
    } else if (offerType === 'PlacementOnly') {
      stipendDiv.style.display = 'none';
      ctcDiv.style.display = 'block';
    } else {
      stipendDiv.style.display = 'block';
      ctcDiv.style.display = 'block';
    }
  }

  function toggleRoundTypeInput(roundNumber) {
    const roundTypeSelect = document.getElementById(`roundType${roundNumber}`);
    const roundTypeInputDiv = document.getElementById(`roundTypeInputDiv${roundNumber}`);
    roundTypeInputDiv.style.display = roundTypeSelect.value === 'Other' ? 'block' : 'none';
  }

  function addRound() {
    roundCount++;
    const newRound = document.createElement('div');
    newRound.classList.add('round-section', 'p-4', 'mb-4', 'rounded-xl', 'border', 'border-indigo-300', 'bg-indigo-50', 'shadow-sm');
    newRound.id = `round${roundCount}`;
    newRound.innerHTML = `
      <div class="round-header font-semibold text-lg text-indigo-700 mb-4">Round ${roundCount}</div>

      <label for="roundType${roundCount}" class="block font-medium text-sm text-gray-700 mb-1">Round Type:</label>
      <select id="roundType${roundCount}" name="roundType${roundCount}" onchange="toggleRoundTypeInput(${roundCount})" required
              class="w-full p-2 mb-4 border border-slate-300 rounded focus:outline-none focus:ring-2 focus:ring-indigo-400 bg-white">
          <option value="Online Assessment">Online Assessment</option>
          <option value="Technical">Technical</option>
          <option value="HR">HR</option>
          <option value="Technical + HR">Technical + HR</option>
          <option value="Other">Other</option>
      </select>

      <div id="roundTypeInputDiv${roundCount}" class="input-box mb-4 hidden">
          <label for="otherRoundType${roundCount}" class="block font-medium text-sm text-gray-700 mb-1">Please specify the round type:</label>
          <input type="text" id="otherRoundType${roundCount}" name="otherRoundType${roundCount}" placeholder="Enter round type"
                 class="w-full p-2 border border-slate-300 rounded focus:outline-none focus:ring-2 focus:ring-indigo-400 bg-white">
      </div>

      <div class="question-section" id="questions${roundCount}">
          <label class="block font-medium text-sm text-gray-700 mb-2">Description:</label>
          <div class="question mb-4">
              <textarea id="q${roundCount}_1" name="q${roundCount}_1" rows="10" cols="50" placeholder="Describe the round, number of students who appeared, number selected, and any relevant details or approach." required class="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-indigo-300"></textarea>
          </div>
      </div>
      <span class="remove-round inline-block px-3 py-1.5 text-sm font-medium text-red-600 border border-red-300 hover:bg-red-50 rounded-md cursor-pointer transition-colors ml-3" onclick="removeRound(${roundCount})"> 🗑 Remove Round </span>
    `;
    document.getElementById('roundsContainer').appendChild(newRound);
  }

  function removeRound(roundNumber) {
    const round = document.getElementById(`round${roundNumber}`);
    if (round){
      round.remove();
      roundCount--;
     }
    const rounds = document.querySelectorAll('.round-section');
    rounds.forEach((round, index) => {
      const header = round.querySelector('.round-header');
      if (header) header.textContent = `Round ${index + 1}`;
    });
  }

  window.onload = function () {
    toggleCompanyInput();
    toggleJobProfileInput();
    toggleOfferFields();
    addRound();
  };
</script>


</body>
</html>
